<!DOCTYPE html>

<html lang="en-us">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Scraping Data from your Bank in Python | Neil Grogan</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
    <link rel="manifest" href="../manifest.json">
    <link rel="mask-icon" href="../safari-pinned-tab.svg" color="#FF3DB4">
    <link rel="me" href="https://mastodon.ie/@dueyfinster">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="../css/main.min.113b8750726301d2272b2fabf9695ed6bfe79dff4f4cd582cb3010010ebceea4.css"/>

    
    
    

    
    

    <script src="https://unpkg.com/lunr/lunr.js"></script>
 
    </head>

    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="../">Neil Grogan</a>
    </div>  
</header>

  <div class="nav-menu">
  
    <a class="color-link nav-link" href="../about">About</a>
  
    <a class="color-link nav-link" href="../uses">Uses</a>
  
    <a class="color-link nav-link" href="../contact">Contact</a>
  
    <a class="color-link nav-link" href="../archives/">Archives</a>
  
    <a class="color-link nav-link" href="../tags/">Tags</a>
  
  <a class="color-link nav-link" href="../index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    

    
    
    

    

    

    

    

    

</div>




	<script src="../js/main.min.a7205ef73b078c8daed6fe1b0826e8ba229ffabbb69d299d9446cf41f2c7d8aa.js" integrity="sha256-pyBe9zsHjI2u1v4bCCbouiKf+ru2nSmdlEbPQfLH2Ko=" crossorigin="anonymous"></script><script src="../js/lunr-search.js" ></script>
</footer>
</nav>

        <div id="content" class="content-container">
        

<h1 class="post-title">Scraping Data from your Bank in Python</h1>
    
    <time>July 12, 2017</time>
    

    <div>
        
        <p>
        <p>As part of my previous posts, I talked about <a href="../ledger">ledger</a> and plain text accounting.  The only part missing is that you need a method to import transactions from your bank. For this I have been doing this by hand, bi-weekly. I would have to do the following:</p>
<ol>
<li>Log in to online banking</li>
<li>Go to the transactions page</li>
<li>Select the date range for transactions I needed (double check last date of  transaction in ledger at this point)</li>
<li>Download the <a href="https://en.wikipedia.org/wiki/Microsoft_Excel">Microsoft Excel</a> format file that wasn&rsquo;t in the proper format</li>
<li>Convert this Excel file into a CSV file that matched my import format (watch the dates, is it YYYY-MM-DD or DD/MM/YYYY?)</li>
<li>Finally import the CSV file into ledger</li>
<li>Check the balance matches between my online banking and ledger</li>
</ol>
<p><em>Sounds like a lot of work right?</em></p>
<p>That&rsquo;s when I decided to write a script to do this (well, some of it)
automatically. I decided to use <a href="https://www.python.org">Python</a> to refresh my skills and then decided I&rsquo;d try to use only my <a href="../ipadpro">iPad Pro</a> to write the code. This made it harder, due to the limited selection of inbuilt modules in <a href="http://omz-software.com/pythonista/">Pythonista</a> app. I researched using modules that I could install via <a href="https://pypi.python.org/pypi">pip</a>, but a lot of these just simply won&rsquo;t work on iOS, as they expect Google Chrome or Mozilla Firefox (ie. they are <a href="http://www.seleniumhq.org/">Selenium</a> based). I decided to use the excellent <a href="http://docs.python-requests.org/en/master/">requests</a> library and <a href="https://www.crummy.com/software/BeautifulSoup/">Beautiful Soup</a> python modules.</p>
<p>This creates a bit of extra work, since we can&rsquo;t execute any <a href="https://en.wikipedia.org/wiki/JavaScript">Javascript</a> on any of the pages. So I first got the contents of my banks login page, and dumped the html to see the:</p>
<ul>
<li>names on the form fields</li>
<li>the endpoint (submit action on form) where data is sent</li>
</ul>
<p>I then created a payload myself, with the data as the browser would send it. Then I got requests to post this data to the correct endpoint (just like a browser does). At first this didn&rsquo;t work, and then I remembered that it could have a <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a> token. When I checked the HTML source, sure enough it did, so I created a function to strip this out and I also sent this with the data. Success! I got to the second login page&hellip;</p>
<p>After this was my pin code, but the bank only asks for digits. I simply put my pin in an array and scraped the digits needed, all minused by 1 (since arrays are 0-indexed). I posted this data the exact same way as before. Next I was in! I could display all my balance info.</p>
<p>The last step was to get the transactions. This proved a bit tricky also since my bank has a download button that&rsquo;s in flash for the Excel file. I was a bit stumped until I noticed they used an open source program called <a href="https://datatables.net/">data tables</a>. In data tables all the fields are nicely marked with what data they contain (be it date, description, money in, money out, etc. etc). I used Beautiful Soup to grab this data, and then finally write it to a CSV file. I was quite happy with the script, and how fast I could pull it together in python!</p>
<p><strong>Warning</strong>: The code below is just to show how it could be done, and was written in a hurry to get a job done. It should be used for ideas, not as a stylistic guide to how you should write nicely named variables with good documentation!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urlparse
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> dropbox
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> csv
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> bs4 <span style="color:#f92672">import</span> BeautifulSoup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USERNAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>PASSWORD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>pin <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>FILENAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bank.csv&#34;</span>
</span></span><span style="display:flex;"><span>start_date <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>quote_plus(datetime(<span style="color:#ae81ff">2017</span>, <span style="color:#ae81ff">05</span>, <span style="color:#ae81ff">15</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">/%m/%Y&#34;</span>))
</span></span><span style="display:flex;"><span>end_date <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>quote_plus(datetime<span style="color:#f92672">.</span>today()<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">/%m/%Y&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ROOT_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.open24.ie/online&#34;</span>
</span></span><span style="display:flex;"><span>LOGIN_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.open24.ie/online/Login/&#34;</span>
</span></span><span style="display:flex;"><span>FORM_ENDPOINT_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.open24.ie/online/&#34;</span>
</span></span><span style="display:flex;"><span>FORM2_ENDPOINT_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.open24.ie/online/Login/Step2&#34;</span>
</span></span><span style="display:flex;"><span>TX_ENDPOINT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.open24.ie/online/Accounts/Details/RecentTransactions&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_data</span>(session, url):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>get(url)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> BeautifulSoup(result<span style="color:#f92672">.</span>content,<span style="color:#e6db74">&#34;html.parser&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">post_data</span>(session, url, data):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>post(url, data<span style="color:#f92672">=</span>data, headers<span style="color:#f92672">=</span>dict(referer <span style="color:#f92672">=</span> LOGIN_URL))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> BeautifulSoup(result<span style="color:#f92672">.</span>content,<span style="color:#e6db74">&#34;html.parser&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> Finds out which digits are requested from PIN
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_pin_digits</span>(soup):
</span></span><span style="display:flex;"><span>    t1 <span style="color:#f92672">=</span> int(soup<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;label&#34;</span>, {<span style="color:#e6db74">&#39;for&#39;</span>: <span style="color:#e6db74">&#39;login-digit-1&#39;</span>})<span style="color:#f92672">.</span>string<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;Digit &#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    t2 <span style="color:#f92672">=</span> int(soup<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;label&#34;</span>, {<span style="color:#e6db74">&#39;for&#39;</span>: <span style="color:#e6db74">&#39;login-digit-2&#39;</span>})<span style="color:#f92672">.</span>string<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;Digit &#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    t3 <span style="color:#f92672">=</span> int(soup<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;label&#34;</span>, {<span style="color:#e6db74">&#39;for&#39;</span>: <span style="color:#e6db74">&#39;login-digit-3&#39;</span>})<span style="color:#f92672">.</span>string<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;Digit &#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> t1, t2, t3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> Gets the Verification token used to submit forms
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_verif_token</span>(soup):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> soup<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;input&#34;</span>, {<span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;__RequestVerificationToken&#39;</span>})<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;value&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> Gets the account UUID generated on login
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_acct_id</span>(soup):
</span></span><span style="display:flex;"><span>    acct_id_url <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;h2&#34;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>: <span style="color:#e6db74">&#39;heading-general&#39;</span>})<span style="color:#f92672">.</span>contents[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;href&#39;</span>]
</span></span><span style="display:flex;"><span>    url_data <span style="color:#f92672">=</span> urlparse<span style="color:#f92672">.</span>urlparse(acct_id_url)
</span></span><span style="display:flex;"><span>    query <span style="color:#f92672">=</span> urlparse<span style="color:#f92672">.</span>parse_qs(url_data<span style="color:#f92672">.</span>query)
</span></span><span style="display:flex;"><span>    acct_id <span style="color:#f92672">=</span> query[<span style="color:#e6db74">&#34;accountId&#34;</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> acct_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    session_requests <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get login csrf token</span>
</span></span><span style="display:flex;"><span>    soup <span style="color:#f92672">=</span> get_data(session_requests, LOGIN_URL)
</span></span><span style="display:flex;"><span>    authenticity_token <span style="color:#f92672">=</span> get_verif_token(soup)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create payload</span>
</span></span><span style="display:flex;"><span>    payload <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;__RequestVerificationToken&#34;</span>: authenticity_token,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;section&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;login-number&#34;</span>: USERNAME, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;login-password&#34;</span>: PASSWORD,   
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Perform initial login</span>
</span></span><span style="display:flex;"><span>    soup <span style="color:#f92672">=</span> post_data(session_requests, LOGIN_URL, payload)
</span></span><span style="display:flex;"><span>    authenticity_token <span style="color:#f92672">=</span> get_verif_token(soup)
</span></span><span style="display:flex;"><span>    t1, t2, t3 <span style="color:#f92672">=</span> get_pin_digits(soup)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create payload</span>
</span></span><span style="display:flex;"><span>    payload <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;__RequestVerificationToken&#34;</span>: authenticity_token,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;login-digit-1&#34;</span>: pin[t1],
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;login-digit-2&#34;</span>: pin[t2], 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;login-digit-3&#34;</span>: pin[t3]  
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Perform 2nd login</span>
</span></span><span style="display:flex;"><span>    soup <span style="color:#f92672">=</span> post_data(session_requests, FORM2_ENDPOINT_URL, payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    avail_funds <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;span&#34;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>: <span style="color:#e6db74">&#39;fund-1&#39;</span>})<span style="color:#f92672">.</span>string<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;ascii&#39;</span>, <span style="color:#e6db74">&#39;ignore&#39;</span>)
</span></span><span style="display:flex;"><span>    cur_bal <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;span&#34;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>: <span style="color:#e6db74">&#39;fund-2&#39;</span>})<span style="color:#f92672">.</span>string<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;ascii&#39;</span>, <span style="color:#e6db74">&#39;ignore&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    acct_id <span style="color:#f92672">=</span> get_acct_id(soup)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Available Funds: &#34;</span>, avail_funds)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Current Balance: &#34;</span>, cur_bal)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Account ID: &#34;</span>, acct_id)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.open24.ie/online/Accounts/Details/RecentTransactions?accountId=&#39;</span><span style="color:#f92672">+</span>acct_id<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;from-date=&#39;</span><span style="color:#f92672">+</span>start_date<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;to-date=&#39;</span><span style="color:#f92672">+</span>end_date
</span></span><span style="display:flex;"><span>    soup <span style="color:#f92672">=</span> get_data(session_requests, url)
</span></span><span style="display:flex;"><span>    valid_trs <span style="color:#f92672">=</span> [item <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> soup<span style="color:#f92672">.</span>find_all(<span style="color:#e6db74">&#39;tr&#39;</span>) <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;data-uid&#34;</span> <span style="color:#f92672">in</span> item<span style="color:#f92672">.</span>attrs]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    outputFile <span style="color:#f92672">=</span> open(FILENAME, <span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>    outputWriter <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>writer(outputFile, lineterminator <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    outputWriter<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;Date&#39;</span>,<span style="color:#e6db74">&#39;Desc&#39;</span>,<span style="color:#e6db74">&#39;In&#39;</span>,<span style="color:#e6db74">&#39;Out&#39;</span>,<span style="color:#e6db74">&#39;Total&#39;</span>])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> tr <span style="color:#f92672">in</span> valid_trs:
</span></span><span style="display:flex;"><span>        date <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>strptime(tr<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;td&#34;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>: <span style="color:#e6db74">&#39;date&#39;</span>})<span style="color:#f92672">.</span>string, <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> %b %y&#39;</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">-%b-%y&#39;</span>)
</span></span><span style="display:flex;"><span>        desc <span style="color:#f92672">=</span> tr<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;td&#34;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>: <span style="color:#e6db74">&#39;desc&#39;</span>})<span style="color:#f92672">.</span>string
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> desc <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            desc <span style="color:#f92672">=</span> tr<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;td&#34;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>: <span style="color:#e6db74">&#39;desc&#39;</span>})<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;a&#39;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>:<span style="color:#e6db74">&#39;underline&#39;</span>})<span style="color:#f92672">.</span>string
</span></span><span style="display:flex;"><span>        desc <span style="color:#f92672">=</span> str(desc)<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>        tds <span style="color:#f92672">=</span> tr<span style="color:#f92672">.</span>findAll(<span style="color:#e6db74">&#34;td&#34;</span>, {<span style="color:#e6db74">&#39;class&#39;</span>: <span style="color:#e6db74">&#39;currency&#39;</span>})
</span></span><span style="display:flex;"><span>        monin <span style="color:#f92672">=</span> tds[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>string
</span></span><span style="display:flex;"><span>        monout <span style="color:#f92672">=</span> tds[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>string
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">=</span> tds[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>string
</span></span><span style="display:flex;"><span>        outputWriter<span style="color:#f92672">.</span>writerow([date, desc, monin, monout, total])
</span></span><span style="display:flex;"><span>    outputFile<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div>
        </p>
    </div>
    

    

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="../tags/automation">#automation</a>
        
            <a class="tag" href="../tags/python">#python</a>
        
            <a class="tag" href="../tags/code">#code</a>
        
            <a class="tag" href="../tags/programming">#programming</a>
        
      
    </div>


        
        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    

    
    
    

    

    

    

    

    

</div>




	<script src="../js/main.min.a7205ef73b078c8daed6fe1b0826e8ba229ffabbb69d299d9446cf41f2c7d8aa.js" integrity="sha256-pyBe9zsHjI2u1v4bCCbouiKf+ru2nSmdlEbPQfLH2Ko=" crossorigin="anonymous"></script>
</footer>
    </body>
</html>