<!doctype html><html lang=en><head><meta charset=utf-8><title>Run Command on SSH Login</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=generator content="Hugo 0.69.0"><link href rel=alternate type=application/rss+xml title="Neil Grogan"><link href=https://www.neilgrogan.com//css/bootstrap.min.css rel=stylesheet><link href=https://www.neilgrogan.com//css/hc.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css rel=stylesheet></head><body><div class=nav-toggle><i class="fa fa-bars fa-2x"></i>Herring Cove</div><div id=wrapper><div class="navbar navbar-default" role=navigation><div class=container><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a href=https://www.neilgrogan.com//><p class=navbar-brand>Neil Grogan</p></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav"></ul></div></div></div><div id=sidebar-wrapper><ul class=sidebar-nav><img src><li class=sidebar-brand><a href=https://www.neilgrogan.com//><h1 class=brand>Neil Grogan</h1></a><h3>My home on the internet</h3></li><hr><hr><div id=social-wrapper></div></ul></div><div class=container><div id=article><div class=article-title>Run Command on SSH Login</div><p class=meta><small>&nbsp;<i class="fa fa-calendar-o"></i> 2016-11-30</small></p><hr><div class=post><p>Do you need to run a command on SSH login? There are a lot of solutions on the web for this, but most of them are very complex. I stumbled across this easy method of using the <code>authorized_keys</code> file, simply add <code>command="ls -l"</code> (replacing <code>ls -l</code> with something a bit more useful like <code>tmux</code> or <code>screen</code>) in front of the key fingerprint. This also means you can have different commands for different keys if you choose.</p><p>Example <code>authorized_keys</code> file:</p><pre><code>command=&quot;tmux a -t &lt;mysessionname&gt;&quot; ssh-rsa AAAAB3...
</code></pre><p>A lot of the other solutions you&rsquo;ll find on the web recommend editing profile, bashrc, ssh_config or some other important shell files - something you should avoid unless absolutely necessary. One more word of advice, make sure the command <em>will always execute sucessfully</em>. If the command fails <em>for any reason</em> (like a Tmux session not existing) your SSH connection will close, since this is the command that will keep it open. That&rsquo;s fine if you have access to the computer and have a screen attached to fix it, but if you are remote then you will be out of luck.</p><p>If you enjoyed this post, you should check out my post on <a href=../ssh-config>using patterns in SSH config file</a>.</p></div></div><a href=https://twitter.com/share class=twitter-share-button data-size=small data-count=none>Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');</script><ul class=pager>&nbsp;<li class=previous><a href=https://www.neilgrogan.com/mosh/>iOS Shells, Prompt vs. Mosh</a></li>&nbsp;<li class=next><a href=https://www.neilgrogan.com/slack-bot/>Slack Bots for Work</a></li></ul></ul></div><footer><p class="text-muted credit">&copy; 2020. All rights reserved.</p></footer><script src=https://www.neilgrogan.com//js/jquery-1.10.2.min.js></script><script src=https://www.neilgrogan.com//js/bootstrap.min.js></script><script src=https://www.neilgrogan.com//js/bootstrap.js></script><script type=text/javascript src=https://www.neilgrogan.com//js/hc.js></script></body></html>